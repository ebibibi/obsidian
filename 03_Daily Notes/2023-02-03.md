- 実際の動きを見ていると、Exchange Onlineの組織の共有や共有ポリシーは無関係に、個別のユーザーが設定した共有設定に従って予定表共有機能が動いているように見える。
- GhatGPT的な品質のエンジンがBingに組み込まれるそうな。ずーっとGoogle派だったけど、ついにBingに乗り換えるときが来たのかもしれない。期待大。
- AzureポータルにアクセスするときにAADテナントを指定するのは結構あちこちで役に立ちますね。 https://portal.azure.com/@AADテナントのドメイン名
- HCCJPの勉強会、とりあえず作って公開した。次回は事実上内輪の相談で、参加者数名でいいや…。
- サービスプリンシパルをグローバル管理者ロールに追加しても外部ユーザーの招待ができない…。そういうもの??
- いや、そんなはずないな。何か勘違いしてそう。
- あれ、サービスプリンシパルで認証してトークン取得してMicrosoft Graphを操作しているつもりなのにエラーに出てくるアプリケーションIDは「GraphAggregatorService」のIDだ。これはいったい?
- あれ、ロールの割り当てのところでは「Microsoft Graph」になるぞ。とりあえずゲスト招待元ロールにMicrosoft Graphを割り当ててみるか…。
- だめだった。サービスプリンシパルで認証した後でトークンを取得してConnect-MgGraphで接続して招待するときに必要な権限…。サービスプリンシパル自体にAPIへのアクセス権限を出すとか、委任権限を出さないと駄目とかそのあたりかな?
- アプリケーションにAPIのアクセス許可としてMicrosoft Graph User.ReadWrite.Allを出しても同じ結果。あれれ？
- そっか、サービスプリンシパルで認証して実行しているんだからユーザーから委任しているのではなくて、アプリケーション自身が実行しているのか。であれば必要なのは「委任されたアクセス許可」ではなく、「アプリケーションの許可」か。
- 「アプリケーションの許可」からMicrosoft GraphのUser.ReadWrite.Allを許可することでうまく動いた。考えてみたら当たり前だ…。
- New-MgInvitationで外部ユーザーを招待した直後にNew-AzRoleAssignmentでアクセス権付与しようとすると失敗する模様。ちょっと時間をおかないと駄目なのかな?
- 時間を置きつつきちんとユーザーが取得できたことを確認する処理を追加したら問題発生しなくなった。とりあえずこれでよかろう。

日: [[2023-02-02]] | [[2023-02-04]]
週: [[2023-01-27]] | [[2023-02-10]]
月: [[2023-01-03]] | [[2023-03-03]]
年: [[2022-02-03]] | [[2024-02-03]]